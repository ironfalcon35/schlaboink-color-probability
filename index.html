<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Schlaboink Breeding Simulator 🎈</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #fff8e7;
      color: #333;
      padding: 40px;
      text-align: center;
      user-select: none;
    }
    input {
      font-size: 1.2em;
      padding: 10px;
      margin: 5px;
      width: 140px;
      text-transform: capitalize;
    }
    button {
      font-size: 1.3em;
      padding: 10px 25px;
      margin-top: 15px;
      cursor: pointer;
      background: #ffbc4b;
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px #d68a00;
      transition: background 0.3s ease;
    }
    button:hover {
      background: #e6a72c;
    }
    #result {
      margin-top: 25px;
      font-size: 2em;
      font-weight: 700;
      height: 70px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #probabilities {
      margin-top: 30px;
      font-size: 1.1em;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      text-align: left;
      background: #fff5d9;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 10px #f5d97688;
      line-height: 1.4;
    }
    .color-swatch {
      display: inline-block;
      width: 14px;
      height: 14px;
      margin-right: 6px;
      border-radius: 3px;
      vertical-align: middle;
      box-shadow: 0 0 2px rgba(0,0,0,0.15);
    }

    #mutation {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        font-size: 2em;
        font-weight: 700;
    }

    #mutation-description {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        font-size: 2em;
        font-weight: 700;
    }

    #mutation-type {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        font-size: 2em;
        font-weight: 700;
    }
  </style>
</head>
<body>
  <h1>🎈 Schlaboink Breeding Simulator 🎈</h1>
  <p>Enter two parent Schlaboink colors and discover your new child's color!</p>

  <input id="parent1" placeholder="Parent 1 color" list="colors" />
  <input id="parent2" placeholder="Parent 2 color" list="colors" />
  <datalist id="colors">
    <option>Red</option><option>Yellow</option><option>Blue</option><option>Green</option><option>Orange</option><option>Purple</option><option>Pink</option><option>White</option>
  </datalist>

  <div id="probabilities"></div>

  <button onclick="startBreeding()" id="breedBtn">Breed!</button>

  <div id="result"></div>

  <p id="mutation"></p>
  <p id="mutation-type"></p>
  <p id="mutation-description"></p>

  <script>
    const colorHex = {
      Red: "#e63946",
      Yellow: "#ffbe0b",
      Blue: "#4361ee",
      Green: "#52b788",
      Orange: "#f3722c",
      Purple: "#A020F0",
      Pink: "#ff6f91",
      White: "#f1faee"
    };

    // Format: "Parent1-Parent2": { Color: Weight, ... }
    const breedingTable = {
      // Primary + Primary
      "Red-Red": { Red: 100 },
      "Red-Yellow": { Red: 25, Yellow: 25, Orange: 50 },
      "Red-Blue": { Red: 25, Blue: 25, Purple: 50 },

      "Yellow-Red": { Red: 25, Yellow: 25, Orange: 50 },
      "Yellow-Yellow": { Yellow: 100 },
      "Yellow-Blue": { Yellow: 25, Blue: 25, Green: 50 },

      "Blue-Red": { Red: 25, Blue: 25, Purple: 50 },
      "Blue-Yellow": { Yellow: 25, Blue: 25, Green: 50 },
      "Blue-Blue": { Blue: 100 },

      // Primary + Secondary
      "Red-Green": { Red: 10, Green: 10, Blue: 5, Yellow: 5, Purple: 15, Orange: 15, White: 3, Pink: 1 },
      "Green-Red": { Red: 10, Green: 10, Blue: 5, Yellow: 5, Purple: 15, Orange: 15, White: 3, Pink: 1 },

      "Red-Orange": { Red: 30, Orange: 25, Yellow: 5, White: 3, Pink: 1 },
      "Orange-Red": { Red: 30, Orange: 25, Yellow: 5, White: 3, Pink: 1 },

      "Red-Purple": { Red: 30, Purple: 25, Blue: 5, White: 3, Pink: 1 },
      "Purple-Red": { Red: 30, Purple: 25, Blue: 5, White: 3, Pink: 1 },

      "Yellow-Green": { Yellow: 30, Green: 25, Blue: 5, White: 3, Pink: 1 },
      "Green-Yellow": { Yellow: 30, Green: 25, Blue: 5, White: 3, Pink: 1 },

      "Yellow-Orange": { Yellow: 30, Orange: 25, Red: 5, White: 3, Pink: 1 },
      "Orange-Yellow": { Yellow: 30, Orange: 25, Red: 5, White: 3, Pink: 1 },

      "Yellow-Purple": { Yellow: 10, Purple: 10, Blue: 5, White: 3, Pink: 1, Orange: 15, Green: 15, Red: 5 },
      "Purple-Yellow": { Yellow: 10, Purple: 10, Blue: 5, White: 3, Pink: 1, Orange: 15, Green: 15, Red: 5 },

      "Blue-Green": { Blue: 30, Green: 25, Yellow: 5, White: 3, Pink: 1, },
      "Green-Blue": { Blue: 30, Green: 25, Yellow: 5, White: 3, Pink: 1, },

      "Blue-Orange": { Blue: 10, Orange: 10, Red: 5, White: 3, Pink: 1, Purple: 15, Green: 15, Yellow: 5 },
      "Orange-Blue": { Blue: 10, Orange: 10, Red: 5, White: 3, Pink: 1, Purple: 15, Green: 15, Yellow: 5 },

      "Blue-Purple": { Blue: 30, Purple: 25, Red: 5, White: 3, Pink: 1, },
      "Purple-Blue": { Blue: 30, Purple: 25, Red: 5, White: 3, Pink: 1, },

      // Secondary + Secondary
      "Green-Green": { Green: 33, Blue: 33, Yellow: 33, White: 10, Pink: 2 },
      "Orange-Orange": { Orange: 33, Red: 33, Yellow: 33, White: 10, Pink: 2 },
      "Purple-Purple": { Purple: 33, Red: 33, Blue: 33, White: 10, Pink: 2 },

      "Green-Orange": { Green: 25, Orange: 25, Blue: 5, Yellow: 25, Purple: 15, Red: 5, White: 8, Pink: 2 },
      "Orange-Green": { Green: 25, Orange: 25, Blue: 5, Yellow: 25, Purple: 15, Red: 5, White: 8, Pink: 2 },

      "Green-Purple": { Green: 25, Purple: 25, Blue: 25, Yellow: 5, Orange: 15, Red: 5, White: 8, Pink: 2 },
      "Purple-Green": { Green: 25, Purple: 25, Blue: 25, Yellow: 5, Orange: 15, Red: 5, White: 8, Pink: 2 },

      "Orange-Purple": { Orange: 25, Purple: 25, Red: 25, Blue: 5, Yellow: 5, Green: 15, White: 8, Pink: 2 },
      "Purple-Orange": { Orange: 25, Purple: 25, Red: 25, Blue: 5, Yellow: 5, Green: 15, White: 8, Pink: 2 },

      // Pink combos
      "Pink-Red": { Pink: 33, Red: 44, Yellow: 11, Blue: 11 },
      "Red-Pink": { Pink: 33, Red: 44, Yellow: 11, Blue: 11 },

      "Pink-Yellow": { Pink: 33, Yellow: 44, Red: 11, Blue: 11 },
      "Yellow-Pink": { Pink: 33, Yellow: 44, Red: 11, Blue: 11 },

      "Pink-Blue": { Pink: 33, Blue: 44, Red: 11, Yellow: 11 },
      "Blue-Pink": { Pink: 33, Blue: 44, Red: 11, Yellow: 11 },

      "Pink-Green": { Pink: 33, Green: 33, Blue: 11, Yellow: 11, Red: 11 },
      "Green-Pink": { Pink: 33, Green: 33, Blue: 11, Yellow: 11, Red: 11 },

      "Pink-Orange": { Pink: 33, Orange: 33, Red: 11, Yellow: 11, Blue: 11 },
      "Orange-Pink": { Pink: 33, Orange: 33, Red: 11, Yellow: 11, Blue: 11 },

      "Pink-Purple": { Pink: 33, Purple: 33, Red: 11, Blue: 11, Yellow: 11 },
      "Purple-Pink": { Pink: 33, Purple: 33, Red: 11, Blue: 11, Yellow: 11 },

      "Pink-Pink": { Pink: 66, Red: 11, Yellow: 11, Blue: 11 },

      "Pink-White": { Pink: 33, White: 33, Red: 11, Yellow: 11, Blue: 11 },
      "White-Pink": { Pink: 33, White: 33, Red: 11, Yellow: 11, Blue: 11 },

      // White combos
      "White-Red": { Red: 50, White: 50},
      "Red-White": { Red: 50, White: 50},

      "White-Yellow": { Yellow: 50, White: 50 },
      "Yellow-White": { Yellow: 50, White: 50 },

      "White-Blue": { Blue: 50, White: 50 },
      "Blue-White": { Blue: 50, White: 50 },

      "White-Green": { Green: 40, White: 50, Blue: 5, Yellow: 5 },
      "Green-White": { Green: 40, White: 50, Blue: 5, Yellow: 5 },

      "White-Orange": { Orange: 40, White: 50, Red: 5, Yellow: 5 },
      "Orange-White": { Orange: 40, White: 50, Red: 5, Yellow: 5 },

      "White-Purple": { Purple: 40, White: 50, Red: 5, Blue: 5 },
      "Purple-White": { Purple: 40, White: 50, Red: 5, Blue: 5 },

      "White-White": { White: 100},
    };

    const mutationTable = {
        "Typical": {
            "001": 1,
            "002": 1,
            "003": 1,
            "004": 1,
            "005": 1,
            "006": 1,
            "007": 1,
            "008": 1,
            "009": 1,
            "010": 1,
            "011": 1,
            "012": 1
        }
    }

    const mutationDesc = {
        "001": "Undersized (Codename \"Mini\")",
        "002": "Rodent-Headed (Codename \"Rathead\")",
        "003": "Overextended Body (Codename \"Stretch\")",
        "004": "Macrocephalic (Codename \"Stevie\")",
        "005": "Microcephalic (Codename \"Pinhead\")",
        "006": "Limbless (Codename \"Sperm Baby\")",
        "007": "Lopsided (Codename \"Tiltwalker\")",
        "008": "Neck-Extended (Codename \"Giraffoid\")",
        "009": "Twin-Bearing (Codename \"Aphrodite\")",
        "010": "No Face (Codename \"Blank\")",
        "011": "Mutant Hybrid (Codename \"Stacked\")"
    }

    // Weighted RNG function
    function getRandomWeightedChoice(weightedOptions) {
      let totalWeight = 0;
      for (const color in weightedOptions) {
        totalWeight += weightedOptions[color];
      }
      let rand = Math.random() * totalWeight;
      let cumulative = 0;
      for (const color in weightedOptions) {
        cumulative += weightedOptions[color];
        if (rand <= cumulative) {
          return color;
        }
      }
      // fallback 
      return Object.keys(weightedOptions)[0];
    }

    // Capitalize input for consistency
    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
    }

    // Show probability table for current input
    function showProbabilities(p1, p2) {
      const key = `${p1}-${p2}`;
      const table = breedingTable[key];
      const container = document.getElementById("probabilities");
      if (!table) {
        container.innerHTML = `<i>No known breeding data for "${p1}" + "${p2}".</i>`;
        return false;
      }
      let html = "<b>Possible offspring colors and chances:</b><br><br>";
      for (const [color, weight] of Object.entries(table)) {
        const total = Object.values(table).reduce((a,b) => a+b, 0);
        const percent = ((weight / total) * 100).toFixed(1);
        html += `<span class="color-swatch" style="background:${colorHex[color] || '#ccc'}"></span> <b>${color}</b>: ${percent}%<br>`;
      }
      container.innerHTML = html;
      return true;
    }

    // Animation logic
    let animInterval = null;
    function animateSelection(options, finalColor) {
      const resultDiv = document.getElementById("result");
      let i = 0;
      let speed = 50; // ms between flips
      let flips = 0;
      const maxFlips = 30;

      clearInterval(animInterval);
      animInterval = setInterval(() => {
        // Show cycling color & name
        const color = options[i % options.length];
        resultDiv.style.color = colorHex[color] || "#000";
        resultDiv.textContent = color;
        i++;
        flips++;

        // Gradual speed slower
        if (flips > maxFlips * 0.7) speed += 15;
        if (flips > maxFlips) {
          clearInterval(animInterval);
          // Show final color with nice formatting
          resultDiv.innerHTML = `🎉 Your Schlaboink is  <span style="color:${colorHex[finalColor] || '#000'};"><b>${finalColor}</b></span>! 🎉`;
            setTimeout(()=>{
                document.getElementById("mutation").innerHTML = `.`;
                setTimeout(()=>{
                    document.getElementById("mutation").innerHTML = `..`;
                    setTimeout(()=>{
                        if (Math.random() < (1/12)) {
                            document.getElementById("mutation").innerHTML = `..!`;
                            setTimeout(() => checkForMutation(true), 1000);
                        } else {
                            document.getElementById("mutation").innerHTML = "...";
                            setTimeout(() => checkForMutation(false), 1000);
                        }
                    }, 500);
                }, 500);
            }, 500);
        }
      }, speed);


    }

    function checkForMutation(isMutated) {
        const mutation = document.getElementById("mutation");
        if (isMutated) {
            mutation.innerHTML = `There is a mutation!`;
            const mutationType = getRandomWeightedChoice(mutationTable["Typical"]);
            setTimeout(() => applyMutation(mutationType, mutation), 1000)
        } else {
            mutation.innerHTML = "No mutation! :)";
        }
    }

    function applyMutation(mutationType, element) {
        types = ["001", "002", "003", "004", "005", "006", "007", "008", "009", "010", "011"];
        element.innerHTML = mutationType;
        let i = 0;
        let max = 100;
        let speed = 50;
        clearInterval(animInterval);
        animInterval = setInterval(() => {
            element.innerHTML = types[Math.floor(Math.random() * 11)];
            i++;
            if (i > max) {
                clearInterval(animInterval);
                element.innerHTML = "The selected mutation type is: " + mutationType;
                setTimeout(() => {
                    document.getElementById("mutation-description").innerHTML = mutationDesc[mutationType];
                }, 500)
            }
            if (i > max * 0.7) {
                speed *= 1.5;
            }
        }, 50)
    }

    function startBreeding() {
      const p1 = capitalize(document.getElementById("parent1").value.trim());
      const p2 = capitalize(document.getElementById("parent2").value.trim());

      document.getElementById("mutation").innerHTML = ``;
      document.getElementById("mutation-type").innerHTML = "";
      document.getElementById("mutation-description").innerHTML = "";

      if (!p1 || !p2) {
        alert("Please enter both parent colors!");
        return;
      }

      if (!showProbabilities(p1, p2)) {
        document.getElementById("result").textContent = "";
        return;
      }

      const key = `${p1}-${p2}`;
      const optionsTable = breedingTable[key];
      if (!optionsTable) {
        document.getElementById("result").textContent = "⍰ No data for this pairing!";
        return;
      }

      // Prepare array of possible colors repeated by weight for RNG simulation in animation
      let colorPool = [];
      for (const color in optionsTable) {
        for (let i = 0; i < optionsTable[color]; i++) {
          colorPool.push(color);
        }
      }

      // Pick final color from weighted RNG
      const finalColor = getRandomWeightedChoice(optionsTable);

      // Animate the color cycling then show final color
      animateSelection([...new Set(colorPool)], finalColor);
    }

    // Show probabilities on input change for instant feedback
    document.getElementById("parent1").addEventListener("input", () => {
      const p1 = capitalize(document.getElementById("parent1").value.trim());
      const p2 = capitalize(document.getElementById("parent2").value.trim());
      showProbabilities(p1, p2);
    });
    document.getElementById("parent2").addEventListener("input", () => {
      const p1 = capitalize(document.getElementById("parent1").value.trim());
      const p2 = capitalize(document.getElementById("parent2").value.trim());
      showProbabilities(p1, p2);
    });
  </script>
</body>
</html>
