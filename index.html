<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Schlaboink Breeding Simulator</title>
  <style>
    body {
      font-family: Comic Sans MS, sans-serif;
      text-align: center;
      background-color: #fff8e7;
      padding: 40px;
    }
    input, button {
      font-size: 1.2em;
      padding: 10px;
      margin: 10px;
    }
    #result {
      font-size: 1.5em;
      margin-top: 20px;
    }
    #animation {
      font-size: 2em;
      margin-top: 20px;
      height: 40px;
    }
    #chances {
      margin-top: 10px;
      font-size: 1.2em;
    }
  </style>
</head>
<body>
  <h1>ðŸŽˆ Schlaboink Breeding Simulator v2 ðŸŽˆ</h1>
  <p>Enter two parent Schlaboink colors to preview chances and discover their floppy destiny!</p>
  
  <input id="parent1" placeholder="Parent 1 color (e.g. Red)" oninput="showChances()" />
  <input id="parent2" placeholder="Parent 2 color (e.g. Yellow)" oninput="showChances()" />
  <button onclick="breed()">Breed!</button>
  
  <div id="chances"></div>
  <div id="animation"></div>
  <div id="result"></div>

  <script>
    const colors = ['Red', 'Yellow', 'Blue', 'Green', 'Orange', 'Purple', 'Pink', 'White'];

    // --- Breeding Table: Every known pairing with weights ---
    const breedingTable = {
      // Primary + Primary
      "Red-Red": { Red: 100 },
      "Red-Yellow": { Red: 25, Yellow: 25, Orange: 50 }, 
      "Red-Blue": { Red: 25, Blue: 25, Purple: 50},
    };

    function getBreedingKey(p1, p2) {
      return `${capitalize(p1)}-${capitalize(p2)}`;
    }

    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
    }

    function getRandomWeightedChoice(weightedOptions) {
      let totalWeight = 0;
      for (let color in weightedOptions) {
        totalWeight += weightedOptions[color];
      }

      let rand = Math.random() * totalWeight;
      let cumulative = 0;

      for (let color in weightedOptions) {
        cumulative += weightedOptions[color];
        if (rand <= cumulative) {
          return color;
        }
      }
    }

    function showChances() {
      const parent1 = capitalize(document.getElementById("parent1").value.trim());
      const parent2 = capitalize(document.getElementById("parent2").value.trim());
      const key = getBreedingKey(parent1, parent2);

      let table = breedingTable[key];
      if (!table) {
        const reversedKey = getBreedingKey(parent2, parent1);
        table = breedingTable[reversedKey];
      }

      if (table) {
        const chanceText = Object.entries(table).map(
          ([color, weight]) => `${color}: ${(weight)}%`
        ).join('<br>');
        document.getElementById("chances").innerHTML = `<b>Chances:</b><br>${chanceText}`;
      } else {
        document.getElementById("chances").innerHTML = `âš ï¸ Unknown pairing. Add it to the table!`;
      }

      document.getElementById("result").innerHTML = "";
      document.getElementById("animation").innerHTML = "";
    }

    function breed() {
      const parent1 = capitalize(document.getElementById("parent1").value.trim());
      const parent2 = capitalize(document.getElementById("parent2").value.trim());
      const key = getBreedingKey(parent1, parent2);
      const reversedKey = getBreedingKey(parent2, parent1);

      let table = breedingTable[key] || breedingTable[reversedKey];

      if (!table) {
        document.getElementById("result").innerHTML = "ðŸ¤·â€â™€ï¸ Unknown pairing!";
        return;
      }

      const possibleColors = Object.keys(table);
      let spinIndex = 0;
      let spinTime = 0;
      let maxSpinTime = 2000 + Math.random() * 1000; // total spin duration 2â€“3s

      const spinInterval = setInterval(() => {
        document.getElementById("animation").innerHTML = `ðŸŽ¡ Spinning: <b>${possibleColors[spinIndex % possibleColors.length]}</b>`;
        spinIndex++;
        spinTime += 100;

        if (spinTime >= maxSpinTime) {
          clearInterval(spinInterval);
          const babyColor = getRandomWeightedChoice(table);
          document.getElementById("animation").innerHTML = "";
          document.getElementById("result").innerHTML = `ðŸŽ‰ Your Schlaboink is <b>${babyColor}</b>! ðŸŽ‰`;
        }
      }, 100);
    }
  </script>
</body>
</html>
